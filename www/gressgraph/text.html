<!DOCTYPE HTML>
<html>
<head>
  <meta name="description" content="gressgraph - visualize your iptables firewall. gressgraph is a small literate Haskell program that uses Graphviz to produce a visual graph of your iptables settings.">
  <meta name="keywords" content="gressgraph, iptables, firewall, graph, graphviz, haskell">
  <title>gressgraph - visualize your iptables firewall</title>
  <style type="text/css">
    body {
      background: url(/image/gressgraph-header) top center no-repeat;
      background-color: #808080;
      width: 66em;
      margin-left: auto;
      margin-right: auto;
    }
    #nav {
      padding: 0.5em 0;
      background-color: #808080;
    }
    #nav li {
      display: inline;
      margin-right: 1em;
    }
    #footer {
      font-size: smaller;
      text-align: center;
      margin-top: 2em;
    }
    #output {
      max-width: 100%;
    }
  </style>
</head>
<body>
  <h1>gressgraph</h1>
  <p style="margin-left: 2em"><i>Visualize your firewall.</i></p>

  <ul id="nav">
    <li><a href="https://github.com/jekor/gressgraph">Source</a></li>
    <li><a href="gressgraph/documentation">Documentation</a></li>
  </ul>

  <p style="clear: left">gressgraph produces a graph of your iptables ruleset using <a href="http://graphviz.org/">Graphviz</a>. You can use the graph to:
    <ul>
      <li>Look for vulnerabilities or redundancies.</li>
      <li>Get a "feel" for a network.</li>
      <li>Showcase your firewall.</li>
    </ul>
  </p>

  <h2>Try It Out</h2>

  <p>Enter the output of <code>iptables -L -vx</code> here.</p>

  <form id="graph" style="text-align: center">
    <textarea name="chains" rows="24" cols="120" required>Chain INPUT (policy DROP 1226127 packets, 148780906 bytes)
    pkts      bytes target     prot opt in     out     source               destination         
   57225  8133562 DROP       all  --  any    any     anywhere             anywhere            state INVALID 
   64147 24178835 DROP       all  --  eth0   any     10.0.0.0/8           anywhere            
      13    12264 DROP       all  --  eth0   any     172.16.0.0/255.250.0.0  anywhere            
    6191   910525 DROP       all  --  eth0   any     192.168.0.0/16       anywhere            
347547935 354119630571 ACCEPT     all  --  any    any     anywhere             anywhere            state RELATED,ESTABLISHED 
   44925 19199122 ACCEPT     udp  --  ath0   any     anywhere             anywhere            udp dpt:bootps 
   70995  4434700 ACCEPT     all  --  lo     any     anywhere             anywhere            
  136396  8110576 ACCEPT     tcp  --  any    any     anywhere             anywhere            tcp dpt:ssh state NEW 
      28     1692 ACCEPT     tcp  --  ath0   any     anywhere             anywhere            state NEW tcp dpt:microsoft-ds 
      79     5020 ACCEPT     tcp  --  ath0   any     anywhere             anywhere            state NEW tcp dpt:netbios-ssn 
       1       60 ACCEPT     tcp  --  ath0   any     anywhere             anywhere            state NEW tcp dpt:domain 
  250743 16275259 ACCEPT     udp  --  ath0   any     anywhere             anywhere            state NEW udp dpt:domain 
    4253   323228 ACCEPT     udp  --  ath0   any     anywhere             anywhere            udp dpt:ntp 
  144691  7305519 ACCEPT     tcp  --  eth0   any     anywhere             anywhere            tcp dpts:10001:10010 state NEW 
      75     4784 ACCEPT     tcp  --  ath0   any     neo                  anywhere            tcp dpt:ipp state NEW 
       0        0 ACCEPT     udp  --  eth0   any     anywhere             anywhere            udp dpt:ntp 
      73    41304 ACCEPT     udp  --  eth1   any     anywhere             anywhere            udp dpt:bootps 
      14      939 ACCEPT     udp  --  eth1   any     anywhere             anywhere            udp dpt:domain 
       0        0 ACCEPT     tcp  --  eth1   any     anywhere             anywhere            tcp dpt:domain 
       0        0 ACCEPT     udp  --  eth1   any     anywhere             anywhere            udp dpt:ntp 
       0        0 ACCEPT     tcp  --  ath0   any     malglata             anywhere            state NEW 

Chain FORWARD (policy DROP 209896 packets, 11331181 bytes)
    pkts      bytes target     prot opt in     out     source               destination         
191412264 130555797638 ACCEPT     all  --  any    any     anywhere             anywhere            state RELATED,ESTABLISHED 
 2457788 184396099 ACCEPT     all  --  ath0   eth0    anywhere             anywhere            
       8      576 ACCEPT     all  --  ath0   ath0    necesiga             anywhere            
      14     1088 ACCEPT     all  --  ath0   ath0    neo                  anywhere            
     117     5616 ACCEPT     all  --  ath0   ath0    malglata             anywhere            
    5786   472056 ACCEPT     all  --  eth1   eth0    anywhere             anywhere            

Chain OUTPUT (policy DROP 3466 packets, 161804 bytes)
    pkts      bytes target     prot opt in     out     source               destination         
274047964 141843115914 ACCEPT     all  --  any    any     anywhere             anywhere            state NEW,RELATED,ESTABLISHED 
       0        0 ACCEPT     all  --  any    lo      anywhere             anywhere            </textarea><br/><br/>
    <input type="submit" value="Graph It"/>
  </form>

  <a><img id="output"></a>

  <h2>About</h2>

  <p>I've deliberately kept the program simple. It has no commandline options.</p>

  <p>I haven't tested gressgraph on many networks. I'm collecting each example that's submitted through this form to help improve the output for more networks.</p>

  <p id="footer">Copyright 2008, 2009 <a href="mailto:jekor@jekor.com">Chris Forno</a></p>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script type="text/javascript">
$(function () {
  $('#graph').submit(function (e) {
    e.preventDefault();
    $.ajax('/gressgraph/graph', {'type': 'POST', 'contentType': 'text/plain', 'data': $('[name=chains]', this).val()})
     .done(function (id) {
       var path = '/gressgraph/graph/' + id;
       $('#output').attr('src', path).closest('a').attr('href', path);
     })
     .fail(function () {
     });
    return false;
  });
});
  </script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-73938-3']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</body>
</html>
